# Goods API

## ๐ท๐บ ะะฟะธัะฐะฝะธะต (Russian)

**Goods API** โ ััะตะฑะฝัะน / pet-ะฟัะพะตะบั backend-ัะตัะฒะธัะฐ ะดะปั ัะฐะฑะพัั ั ัะพะฒะฐัะฐะผะธ.
ะัะพะตะบั ะดะตะผะพะฝัััะธััะตั ัะธะฟะธัะฝัั ะฐััะธัะตะบัััั API-ะฟัะธะปะพะถะตะฝะธั ะฝะฐ Python ั ัะฐะทะดะตะปะตะฝะธะตะผ ะฝะฐ ะดะพะผะตะฝั, ะบะพะฝัะธะณััะฐัะธั, ะธะฝััะฐััััะบัััั ะธ ะดะตะฟะปะพะน.

ะฆะตะปั ะฟัะพะตะบัะฐ:

* ะพััะฐะฑะพัะฐัั ััััะบัััั backend-ะฟัะธะปะพะถะตะฝะธั
* ะฟะพะบะฐะทะฐัั ัะฐะฑะพัั ั ะะ
* ะฟะพะดะณะพัะพะฒะธัั ัะตัะฒะธั ะบ ะบะพะฝัะตะนะฝะตัะธะทะฐัะธะธ ะธ ะดะตะฟะปะพั
* ะฟัะธะฑะปะธะทะธัััั ะบ real-world backend ัะฐะทัะฐะฑะพัะบะต
* ัะตะฐะปะธะทะพะฒะฐัั ะฟะพะปะฝะพัะตะฝะฝัะน ะผะพะฝะธัะพัะธะฝะณ ะธ ะปะพะณะธัะพะฒะฐะฝะธะต

---

## ๐ ะะพะทะผะพะถะฝะพััะธ

* REST API ะดะปั ัะฐะฑะพัั ั ัะพะฒะฐัะฐะผะธ
* ะงััะบะพะต ัะฐะทะดะตะปะตะฝะธะต ัะปะพัะฒ (routers / models / database)
* ะะพะฝัะธะณััะฐัะธั ัะตัะตะท YAML
* Docker ะธ docker-compose
* Kubernetes manifests
* Terraform ะบะพะฝัะธะณััะฐัะธั
* Poetry ะดะปั ัะฟัะฐะฒะปะตะฝะธั ะทะฐะฒะธัะธะผะพัััะผะธ
* **ะัััะพะตะฝะฝัะต ะผะตััะธะบะธ Prometheus**
* **ะะพัะพะฒะฝะพััั ะบ ะธะฝัะตะณัะฐัะธะธ ั Grafana ะธ Loki**

---

## ๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ (ะพะฑะฝะพะฒะปัะฝะฝะฐั)

```text
.
โโโ api_deployment.yml
โโโ api_service.yml
โโโ app
โยย โโโ config
โยย โยย โโโ conf.py
โยย โโโ database
โยย โยย โโโ db.py
โยย โยย โโโ __init__.py
โยย โโโ goods
โยย โยย โโโ __init__.py
โยย โยย โโโ models
โยย โยย โยย โโโ goods.py
โยย โยย โยย โโโ __init__.py
โยย โยย โโโ routers
โยย โยย     โโโ goods.py
โยย โยย     โโโ __init__.py
โยย โโโ __init__.py
โยย โโโ metrics
โยย โยย โโโ goods.py
โยย โยย โโโ http.py
โยย โยย โโโ __init__.py
โยย โโโ middleware
โยย     โโโ prometheus.py
โโโ db_config.yml
โโโ db_secrets_example.yml
โโโ docker-compose.yml
โโโ Dockerfile
โโโ LICENSE
โโโ main.py
โโโ main.tf
โโโ mixed-load.sh
โโโ monitoring
โยย โโโ prometheus
โยย     โโโ prometheus.yml
โโโ poetry.lock
โโโ postgres_pvc.yml
โโโ postgres_service.yml
โโโ postgres_stateful.yml
โโโ pyproject.toml
โโโ README.md---

## โ ะะปะฐะฝ ัะฐะทะฒะธัะธั ะฟัะพะตะบัะฐ (Roadmap)

- [x] **ะะพะฑะฐะฒะปะตะฝ Prometheus ะดะปั ัะฑะพัะฐ ะผะตััะธะบ**
  - ะะตััะธะบะธ HTTP ะทะฐะฟัะพัะพะฒ (ะบะพะปะธัะตััะฒะพ, ะดะปะธัะตะปัะฝะพััั, ััะฐัััั)
  - ะะธะทะฝะตั-ะผะตััะธะบะธ ัะพะฒะฐัะพะฒ (ะบะพะปะธัะตััะฒะพ ัะพะทะดะฐะฝะฝัั/ะพะฑะฝะพะฒะปัะฝะฝัั ัะพะฒะฐัะพะฒ)
  - ะญะฝะดะฟะพะธะฝั `/metrics` ะดะปั ัะฑะพัะฐ ะดะฐะฝะฝัั Prometheus
  - Middleware ะดะปั ะฐะฒัะพะผะฐัะธัะตัะบะพะณะพ ัะฑะพัะฐ HTTP ะผะตััะธะบ

- [x] **ะะพะฑะฐะฒะธัั ะดะฐัะฑะพัะด Grafana ะดะปั ะฒะธะทัะฐะปะธะทะฐัะธะธ ะผะตััะธะบ**
  - ะกะพะทะดะฐัั ะณะพัะพะฒัะต ะดะฐัะฑะพัะดั ะดะปั:
    - ะะพะฝะธัะพัะธะฝะณะฐ ัะพััะพัะฝะธั API (HTTP ะผะตััะธะบะธ)
    - ะะธะทะฝะตั-ะผะตััะธะบ ัะพะฒะฐัะพะฒ
    - ะะพะฝะธัะพัะธะฝะณะฐ ะทะดะพัะพะฒัั ะฑะฐะทั ะดะฐะฝะฝัั
  - ะะฐัััะพะธัั ะฐะปะตััั ะฝะฐ ะพัะฝะพะฒะต ะผะตััะธะบ
  - ะะพะฑะฐะฒะธัั ะบะพะฝัะธะณััะฐัะธั Grafana ะฒ docker-compose ะธ Kubernetes

- [ ] **ะะตะฐะปะธะทะพะฒะฐัั ะปะพะณะธัะพะฒะฐะฝะธะต ั ะฟะพะผะพััั Loki + Promtail**
  - ะะฐัััะพะธัั ัะฑะพั ะปะพะณะพะฒ ะฟัะธะปะพะถะตะฝะธั
  - ะะฝัะตะณัะธัะพะฒะฐัั ั Grafana ะดะปั ะตะดะธะฝะพะณะพ ะธะฝัะตััะตะนัะฐ
  - ะกะพะทะดะฐัั ะดะฐัะฑะพัะดั ะดะปั ะฐะฝะฐะปะธะทะฐ ะปะพะณะพะฒ
  - ะะตะฐะปะธะทะพะฒะฐัั ััััะบัััะธัะพะฒะฐะฝะฝะพะต ะปะพะณะธัะพะฒะฐะฝะธะต (JSON-ัะพัะผะฐั)

- [ ] **ะะฐัััะพะธัั ะฐะปะตััะธะฝะณ**
  - ะกะพะทะดะฐัั ะฟัะฐะฒะธะปะฐ ะฐะปะตััะธะฝะณะฐ ะฒ Prometheus
  - ะะฝัะตะณัะธัะพะฒะฐัั ั Alertmanager
  - ะะฐัััะพะธัั ัะฒะตะดะพะผะปะตะฝะธั (email, Slack, Telegram)




---

## ๐ณ ะะฐะฟััะบ ัะตัะตะท Docker (ั ะผะตััะธะบะฐะผะธ)

```bash
docker-compose up --build
```

ะะพัะปะต ะทะฐะฟััะบะฐ API ะฑัะดะตั ะดะพัััะฟะตะฝ:
- ะัะฝะพะฒะฝะพะต API: `http://localhost:8000`
- ะะพะบัะผะตะฝัะฐัะธั Swagger: `http://localhost:8000/docs`
- ะะตััะธะบะธ Prometheus: `http://localhost:8000/metrics`
- ะะฐัะฑะพัะด Grafana: `http://localhost:3000` 
---

## ๐ ะะตััะธะบะธ Prometheus (ัะถะต ัะตะฐะปะธะทะพะฒะฐะฝะพ)

ะกะตัะฒะธั ะฟัะตะดะพััะฐะฒะปัะตั ัะปะตะดัััะธะต ะผะตััะธะบะธ:

### HTTP ะผะตััะธะบะธ
- `http_requests_total` - ะพะฑัะตะต ะบะพะปะธัะตััะฒะพ HTTP ะทะฐะฟัะพัะพะฒ
- `http_request_duration_seconds` - ะดะปะธัะตะปัะฝะพััั HTTP ะทะฐะฟัะพัะพะฒ
- `http_requests_in_progress` - ัะตะบััะธะต ะฒัะฟะพะปะฝัััะธะตัั ะทะฐะฟัะพัั

### ะะธะทะฝะตั ะผะตััะธะบะธ ัะพะฒะฐัะพะฒ
- `goods_created_total` - ะบะพะปะธัะตััะฒะพ ัะพะทะดะฐะฝะฝัั ัะพะฒะฐัะพะฒ
- `goods_updated_total` - ะบะพะปะธัะตััะฒะพ ะพะฑะฝะพะฒะปัะฝะฝัั ัะพะฒะฐัะพะฒ
- `goods_operations_total` - ะพะฑัะตะต ะบะพะปะธัะตััะฒะพ ะพะฟะตัะฐัะธะน ั ัะพะฒะฐัะฐะผะธ

---

## โธ Kubernetes

ะ ัะตะฟะพะทะธัะพัะธะธ ะฟัะธัััััะฒััั ะผะฐะฝะธัะตััั ะดะปั ะดะตะฟะปะพั:

* API
* PostgreSQL (StatefulSet + PVC + Service)

ะคะฐะนะปั:

* `api_deployment.yml`
* `api_service.yml`
* `postgres_stateful.yml`
* `postgres_pvc.yml`
* `postgres_service.yml`

---

## ๐งฑ Terraform

ะคะฐะนะป `main.tf` ัะพะดะตัะถะธั ะฑะฐะทะพะฒัั Terraform-ะบะพะฝัะธะณััะฐัะธั ะธ ะผะพะถะตั ะฑััั ะธัะฟะพะปัะทะพะฒะฐะฝ
ะดะปั ัะฐะทะฒััััะฒะฐะฝะธั ะธะฝััะฐััััะบัััั (ะฒ ะทะฐะฒะธัะธะผะพััะธ ะพั ะฒัะฑัะฐะฝะฝะพะณะพ ะฟัะพะฒะฐะนะดะตัะฐ).

---

## ๐ Secrets

โ๏ธ **ะะฐะถะฝะพ**

ะคะฐะนะป `db_secrets.yml`:

* ัะพะดะตัะถะธั ััะฒััะฒะธัะตะปัะฝัะต ะดะฐะฝะฝัะต
* **ะฝะต ะดะพะปะถะตะฝ ะฑััั ะทะฐะบะพะผะผะธัะตะฝ**
* ะธัะฟะพะปัะทัะตััั ัะพะปัะบะพ ะปะพะบะฐะปัะฝะพ ะธะปะธ ัะตัะตะท CI/CD

ะ ัะตะฟะพะทะธัะพัะธะธ ััะฐะฝะธััั ัะพะปัะบะพ:

```text
db_secrets_example.yml
```

---

## ๐ ะขะตัะฝะพะปะพะณะธะธ

* Python
* FastAPI (ะธะปะธ ะฐะฝะฐะปะพะณะธัะฝัะน ASGI-ััะตะนะผะฒะพัะบ)
* PostgreSQL
* **Prometheus** (ะผะตััะธะบะธ)
* Docker / Docker Compose
* Kubernetes
* Terraform
* Poetry

---

## ๐ ะกัะฐััั ะฟัะพะตะบัะฐ

ะัะพะตะบั ะฝะฐัะพะดะธััั ะฒ ะฐะบัะธะฒะฝะพะน ัะฐะทัะฐะฑะพัะบะต. ะะตะฐะปะธะทะพะฒะฐะฝะพ:

- [x] ะะฐะทะพะฒะฐั ััััะบัััะฐ API
- [x] ะะฐะฑะพัะฐ ั ะฑะฐะทะพะน ะดะฐะฝะฝัั
- [x] ะะพะฝัะตะนะฝะตัะธะทะฐัะธั (Docker)
- [x] ะะพะฝัะธะณััะฐัะธั Kubernetes
- [x] **ะะตััะธะบะธ Prometheus**
- [x] ะะฐัะฑะพัะดั Grafana
- [ ] ะะพะณะธัะพะฒะฐะฝะธะต Loki+Promtail
- [ ] ะะพะปะฝะพะต ะผะพะฝะธัะพัะธะฝะณะพะฒะพะต ัะตัะตะฝะธะต

ะัะฟะพะปัะทัะตััั ะบะฐะบ:
* ััะตะฑะฝัะน ะฟัะพะตะบั
* playground ะดะปั backend / DevOps ะฟัะฐะบัะธะบ
* ะฟัะธะผะตั ัะตะฐะปะธะทะฐัะธะธ ะผะพะฝะธัะพัะธะฝะณะฐ ะฒ Python ะฟัะธะปะพะถะตะฝะธัั

---

# Goods API

## üá∑üá∫ –û–ø–∏—Å–∞–Ω–∏–µ (Russian)

**Goods API** ‚Äî —É—á–µ–±–Ω—ã–π / pet-–ø—Ä–æ–µ–∫—Ç backend-—Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–æ–≤–∞—Ä–∞–º–∏.
–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ç–∏–ø–∏—á–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É API-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ Python —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –Ω–∞ –¥–æ–º–µ–Ω—ã, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é, –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –¥–µ–ø–ª–æ–π.

–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞:

* –æ—Ç—Ä–∞–±–æ—Ç–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É backend-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
* –ø–æ–∫–∞–∑–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –ë–î
* –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –¥–µ–ø–ª–æ—é
* –ø—Ä–∏–±–ª–∏–∑–∏—Ç—å—Å—è –∫ real-world backend —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
* —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

* REST API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–æ–≤–∞—Ä–∞–º–∏
* –ß—ë—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–ª–æ—ë–≤ (routers / models / database)
* –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ YAML
* Docker –∏ docker-compose
* Kubernetes manifests
* Terraform –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
* Poetry –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
* **–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ Prometheus**
* **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Grafana –∏ Loki**

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–æ–±–Ω–æ–≤–ª—ë–Ω–Ω–∞—è)

```text
.
‚îú‚îÄ‚îÄ api_deployment.yml        # Kubernetes Deployment –¥–ª—è API
‚îú‚îÄ‚îÄ api_service.yml           # Kubernetes Service –¥–ª—è API
‚îú‚îÄ‚îÄ app/                      # –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ config/               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ conf.py
‚îÇ   ‚îú‚îÄ‚îÄ database/             # –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ db.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ goods/                # –î–æ–º–µ–Ω "—Ç–æ–≤–∞—Ä—ã"
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models/           # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ goods.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routers/          # HTTP —Ä–æ—É—Ç—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ goods.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ metrics/              # –ú–µ—Ç—Ä–∏–∫–∏ Prometheus
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ goods.py          # –ë–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ http.py           # HTTP –º–µ—Ç—Ä–∏–∫–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ middleware/           # –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–µ –ü–û
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ prometheus.py     # Middleware –¥–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫
‚îÇ   ‚îî‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ db_config.yml             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ë–î
‚îú‚îÄ‚îÄ db_secrets_example.yml    # –ü—Ä–∏–º–µ—Ä secrets (–±–µ–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)
‚îú‚îÄ‚îÄ db_secrets.yml            # –†–µ–∞–ª—å–Ω—ã–µ secrets (–Ω–µ –¥–æ–ª–∂–µ–Ω –ø–æ–ø–∞–¥–∞—Ç—å –≤ git)
‚îú‚îÄ‚îÄ docker-compose.yml        # –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫
‚îú‚îÄ‚îÄ Dockerfile                # Docker –æ–±—Ä–∞–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ main.py                   # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ main.tf                   # Terraform –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ monitoring/               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
‚îÇ   ‚îî‚îÄ‚îÄ prometheus/
‚îÇ       ‚îî‚îÄ‚îÄ prometheus.yml    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Prometheus
‚îú‚îÄ‚îÄ postgres_pvc.yml          # Kubernetes PVC –¥–ª—è Postgres
‚îú‚îÄ‚îÄ postgres_service.yml      # Kubernetes Service –¥–ª—è Postgres
‚îú‚îÄ‚îÄ postgres_stateful.yml     # Kubernetes StatefulSet –¥–ª—è Postgres
‚îú‚îÄ‚îÄ pyproject.toml            # Poetry –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ poetry.lock
‚îú‚îÄ‚îÄ README.md
‚îî‚îÄ‚îÄ LICENSE
```

---

## ‚úÖ –ü–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è –ø—Ä–æ–µ–∫—Ç–∞ (Roadmap)

- [x] **–î–æ–±–∞–≤–ª–µ–Ω Prometheus –¥–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫**
  - –ú–µ—Ç—Ä–∏–∫–∏ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —Å—Ç–∞—Ç—É—Å—ã)
  - –ë–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö/–æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤)
  - –≠–Ω–¥–ø–æ–∏–Ω—Ç `/metrics` –¥–ª—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö Prometheus
  - Middleware –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–±–æ—Ä–∞ HTTP –º–µ—Ç—Ä–∏–∫

- [ ] **–î–æ–±–∞–≤–∏—Ç—å –¥–∞—à–±–æ—Ä–¥ Grafana –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –º–µ—Ç—Ä–∏–∫**
  - –°–æ–∑–¥–∞—Ç—å –≥–æ—Ç–æ–≤—ã–µ –¥–∞—à–±–æ—Ä–¥—ã –¥–ª—è:
    - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è API (HTTP –º–µ—Ç—Ä–∏–∫–∏)
    - –ë–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫ —Ç–æ–≤–∞—Ä–æ–≤
    - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∑–¥–æ—Ä–æ–≤—å—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
  - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–µ—Ç—Ä–∏–∫
  - –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Grafana –≤ docker-compose –∏ Kubernetes

- [ ] **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é Loki + Promtail**
  - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–±–æ—Ä –ª–æ–≥–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
  - –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å Grafana –¥–ª—è –µ–¥–∏–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
  - –°–æ–∑–¥–∞—Ç—å –¥–∞—à–±–æ—Ä–¥—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ª–æ–≥–æ–≤
  - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (JSON-—Ñ–æ—Ä–º–∞—Ç)

- [ ] **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç–∏–Ω–≥**
  - –°–æ–∑–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –∞–ª–µ—Ä—Ç–∏–Ω–≥–∞ –≤ Prometheus
  - –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å Alertmanager
  - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (email, Slack, Telegram)




---

## üê≥ –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker (—Å –º–µ—Ç—Ä–∏–∫–∞–º–∏)

```bash
docker-compose up --build
```

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω:
- –û—Å–Ω–æ–≤–Ω–æ–µ API: `http://localhost:8000`
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Swagger: `http://localhost:8000/docs`
- –ú–µ—Ç—Ä–∏–∫–∏ Prometheus: `http://localhost:8000/metrics`

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ Prometheus (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)

–°–µ—Ä–≤–∏—Å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏:

### HTTP –º–µ—Ç—Ä–∏–∫–∏
- `http_requests_total` - –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
- `http_request_duration_seconds` - –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
- `http_requests_in_progress` - —Ç–µ–∫—É—â–∏–µ –≤—ã–ø–æ–ª–Ω—è—é—â–∏–µ—Å—è –∑–∞–ø—Ä–æ—Å—ã

### –ë–∏–∑–Ω–µ—Å –º–µ—Ç—Ä–∏–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤
- `goods_created_total` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
- `goods_updated_total` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
- `goods_operations_total` - –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π —Å —Ç–æ–≤–∞—Ä–∞–º–∏

---

## ‚ò∏ Kubernetes

–í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã –¥–ª—è –¥–µ–ø–ª–æ—è:

* API
* PostgreSQL (StatefulSet + PVC + Service)

–§–∞–π–ª—ã:

* `api_deployment.yml`
* `api_service.yml`
* `postgres_stateful.yml`
* `postgres_pvc.yml`
* `postgres_service.yml`

---

## üß± Terraform

–§–∞–π–ª `main.tf` —Å–æ–¥–µ—Ä–∂–∏—Ç –±–∞–∑–æ–≤—É—é Terraform-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω
–¥–ª—è —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞).

---

## üîê Secrets

‚ö†Ô∏è **–í–∞–∂–Ω–æ**

–§–∞–π–ª `db_secrets.yml`:

* —Å–æ–¥–µ—Ä–∂–∏—Ç —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
* **–Ω–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–∫–æ–º–º–∏—á–µ–Ω**
* –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ –∏–ª–∏ —á–µ—Ä–µ–∑ CI/CD

–í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —Ö—Ä–∞–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ:

```text
db_secrets_example.yml
```

---

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

* Python
* FastAPI (–∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π ASGI-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫)
* PostgreSQL
* **Prometheus** (–º–µ—Ç—Ä–∏–∫–∏)
* Docker / Docker Compose
* Kubernetes
* Terraform
* Poetry

---

## üìå –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∞–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

- [x] –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ API
- [x] –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- [x] –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è (Docker)
- [x] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Kubernetes
- [x] **–ú–µ—Ç—Ä–∏–∫–∏ Prometheus**
- [ ] –î–∞—à–±–æ—Ä–¥—ã Grafana
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ Loki+Promtail
- [ ] –ü–æ–ª–Ω–æ–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫:
* —É—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç
* playground –¥–ª—è backend / DevOps –ø—Ä–∞–∫—Ç–∏–∫
* –ø—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≤ Python –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö

---
